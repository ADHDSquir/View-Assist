- sensor:
  - name: AssistSat_ViewLR
    state: ""
    attributes:
      mode: "normal"
      mic_device: "sensor.firehd_7_stt"
      mediaplayer_device: "media_player.tabletfullkiosk"
      display_device: "sensor.tabletfullkiosk_browser_path"
      browser_id: "Tabletfullkiosk"      
      view_timeout: "20"
      title: ""
      message: ""
      message_font_size: "3vw"
      image: ""
      timer: ""
      alarm: ""
      cycle_view: ""
      do_not_disturb: false

  - name: AssistSat_ViewLRThinksmart
    state: ""
    attributes:
      mode: "normal"
      mic_device: "sensor.thinksmart_lr_stt"
      mediaplayer_device: "media_player.thinksmart_lr"
      display_device: "sensor.thinksmart_lr_browser_path"
      browser_id: "Thinksmart-LR"   
      view_timeout: "20"
      title: ""
      message: ""
      message_font_size: "3vw"
      image: ""
      timer: "timer.thinksmart_lr"
      alarm: ""
      cycle_view: ""
      do_not_disturb: false

  - name: AssistSat_ViewMaster
    state: ""
    attributes:
      mode: "normal"
      mic_device: "sensor.tablet_master_stt"
      mediaplayer_device: "media_player.tabletmaster"
      display_device: "sensor.tabletmaster_browser_path"
      browser_id: "TabletMaster"
      view_timeout: "20"
      title: ""
      message: ""
      message_font_size: "3vw"
      image: ""
      timer: ""
      alarm: ""
      cycle_view: ""
      do_not_disturb: false


  - name: Assist_Last_Called
    state: >-
      {%- set sensors = expand(['group.assist_mics'])|selectattr('state', 'eq', 'start')|rejectattr('last_changed', 'eq', None)|list -%}
      {{ sensors|max(attribute="last_changed")|attr('entity_id') if sensors|length >= 1 else 'None'}}

  - name: Assist_Target_Display_Device
    state: >-
      {{ device_id (expand('group.assist_satellites') | selectattr('attributes.mic_device', 'eq',states('sensor.assist_last_called')) | map(attribute='attributes.display_device') | first) }}

  - name: Assist_Target_Mediaplayer_Device
    state: >-
      {{ (expand('group.assist_satellites') | selectattr('attributes.mic_device', 'eq',states('sensor.assist_last_called')) | map(attribute='attributes.mediaplayer_device') | list| first) }}
 